{
  "chapter": 9,
  "title": "Functions",
  "fls_url": "https://rust-lang.github.io/fls/functions.html",
  "fls_id": "fls_qcb1n9c0e5hz",
  "repository": "eclipse-iceoryx/iceoryx2",
  "version": "0.8.0",
  "analysis_date": "2025-12-30",
  "version_changes": {
    "from_version": "0.7.0",
    "to_version": "0.8.0",
    "summary": "Major increase in function count due to expanded FFI layer. Total functions increased 72% (4909->8422). extern C fn increased dramatically (17->630) for C bindings. #[no_mangle] increased from minimal to 602 for FFI exports.",
    "key_changes": [
      "Directory structure changed: iceoryx2-bb-*-0.7.0/ -> iceoryx2-bb/*/",
      "Total fn declarations increased from 4909 to 8422 (+72%)",
      "pub fn increased from 1230 to 2809 (+128%)",
      "unsafe fn increased from 1302 to 1763 (+35%)",
      "extern C fn increased from 17 to 630 (+3606%) for FFI layer",
      "#[no_mangle] increased from minimal to 602 for C bindings",
      "const fn increased from 101 to 113 (+12%)",
      "impl blocks increased from 1353 to 2397 (+77%)",
      "where clauses increased from 94 to 182 (+94%)",
      "generic functions increased from 1002 to 1425 (+42%)",
      "Functions returning Result increased from 626 to 835 (+33%)",
      "Functions returning Self increased from 679 to 1107 (+63%)"
    ]
  },
  "summary": "FLS Chapter 9 defines functions as values of function types that model behavior. Each function declares a unique function item type. The chapter covers function qualifiers (const, async, unsafe), function parameters (including self parameter for methods), return types, function bodies, and function signatures. iceoryx2 v0.8.0 demonstrates massive growth in FFI functions for C/C++ bindings, heavy use of unsafe functions for systems programming, and const functions for compile-time evaluation.",
  "statistics": {
    "total_fn_declarations": 9884,
    "pub_fn": 2809,
    "unsafe_fn": 1763,
    "const_fn": 113,
    "extern_c_fn": 630,
    "async_fn": 0,
    "no_mangle_functions": 602,
    "generic_functions": 1418,
    "fn_new_constructors": 354,
    "return_result": 1396,
    "return_option": 235,
    "return_self": 1216,
    "ref_self": 1537,
    "ref_mut_self": 265,
    "owned_self": 530
  },
  "sections": {
    "function_declaration": {
      "fls_section": "9.0.1",
      "fls_ids": [],
      "description": "Function Declaration",
      "status": "demonstrated",
      "findings": {
        "total_declarations": 9884,
        "pub_functions": 2809
      },
      "samples": [
        {
          "file": "iceoryx2-bb/posix/src/mutex.rs",
          "line": [281, 282, 283],
          "code": "pub fn new() -> Self { Self::default() }",
          "purpose": "Public constructor following Rust new() naming convention"
        },
        {
          "file": "iceoryx2/src/config.rs",
          "line": [236, 237, 238, 239, 240],
          "code": "pub fn service_dir(&self) -> Path {\n    let mut path = *self.root_path();\n    path.add_path_entry(&self.service.directory).unwrap();\n    path\n}",
          "purpose": "Public getter function returning computed Path value"
        },
        {
          "file": "iceoryx2/src/config.rs",
          "line": [622],
          "code": "pub fn from_file(config_file: &FilePath) -> Result<Config, ConfigCreationError> {",
          "purpose": "Associated function for constructing Config from file"
        }
      ],
      "count": 9977
    },
    "function_qualifier_list": {
      "fls_section": "9.0.2",
      "fls_ids": [],
      "description": "Function Qualifier List",
      "status": "demonstrated",
      "findings": {
        "const_fn": 113,
        "unsafe_fn": 1763,
        "async_fn": 0,
        "extern_c_fn": 630,
        "note": "async fn intentionally avoided for deterministic behavior"
      },
      "samples": [
        {
          "file": "iceoryx2-bb/elementary/src/lazy_singleton.rs",
          "line": [60, 61, 62],
          "code": "pub const fn new() -> Self { ... }",
          "purpose": "const fn constructor enabling compile-time singleton initialization"
        },
        {
          "file": "iceoryx2-ffi/c/src/api/service_name.rs",
          "line": [125, 126, 127],
          "code": "#[no_mangle] pub unsafe extern \"C\" fn iox2_service_name_new(...)",
          "purpose": "FFI function with extern C ABI, unsafe for raw pointer handling"
        },
        {
          "file": "iceoryx2-bb/posix/src/mutex.rs",
          "line": [552],
          "code": "pub fn lock(&self) -> Result<MutexGuard<T>, MutexLockError<T>>",
          "purpose": "Public function with Result return type for fallible mutex acquisition"
        }
      ],
      "count": 1876
    },
    "function_parameter_list": {
      "fls_section": "9.0.3",
      "fls_ids": [],
      "description": "Function Parameter List",
      "status": "demonstrated",
      "findings": {
        "variadic_functions": 0
      },
      "samples": [
        {
          "file": "iceoryx2-ffi/c/src/api/service_name.rs",
          "line": [126, 127, 128],
          "code": "service_name_struct_ptr: *mut iox2_service_name_t, service_name_str: *const c_char",
          "purpose": "C-compatible raw pointer parameters for FFI function"
        },
        {
          "file": "iceoryx2/src/sample.rs",
          "line": [76],
          "code": "fn fmt(&self, f: &mut core::fmt::Formatter<'_>) -> core::fmt::Result {",
          "purpose": "Debug trait implementation with self and formatter parameters"
        },
        {
          "file": "iceoryx2/src/service/dynamic_config/request_response.rs",
          "line": [182],
          "code": "pub fn list_servers<F: FnMut(&ServerDetails) -> CallbackProgression>(&self, mut callback: F)",
          "purpose": "Generic parameter with FnMut trait bound for callback"
        }
      ],
      "count": 5591
    },
    "function_parameter": {
      "fls_section": "9.0.4",
      "fls_ids": [],
      "description": "Function Parameter",
      "status": "demonstrated",
      "findings": {
        "all_typed": true,
        "fn_mut_callbacks": 106
      },
      "samples": [
        {
          "file": "iceoryx2/src/service/dynamic_config/request_response.rs",
          "line": [182],
          "code": "pub fn list_servers<F: FnMut(&ServerDetails) -> CallbackProgression>(&self, mut callback: F)",
          "purpose": "Function with mut callback parameter for iteration with early exit"
        },
        {
          "file": "iceoryx2-bb/container/src/semantic_string.rs",
          "line": [83],
          "code": "fn from(value: StringModificationError) -> Self {",
          "purpose": "From trait parameter for type conversion"
        },
        {
          "file": "iceoryx2/src/config.rs",
          "line": [255],
          "code": "pub fn set_root_path(&mut self, value: &Path) {",
          "purpose": "Setter function with &mut self and reference parameter"
        }
      ],
      "count": 5591
    },
    "function_parameter_pattern": {
      "fls_section": "9.0.5",
      "fls_ids": [],
      "description": "Function Parameter Pattern",
      "status": "demonstrated",
      "findings": {
        "patterns": [
          "simple identifiers",
          "mut bindings"
        ]
      },
      "samples": [
        {
          "file": "iceoryx2-bb/container/src/semantic_string.rs",
          "line": [83, 84],
          "code": "fn from(value: StringModificationError) -> Self {\n    match value {",
          "purpose": "Simple identifier pattern in From trait implementation"
        },
        {
          "file": "iceoryx2/src/config.rs",
          "line": [622],
          "code": "pub fn from_file(config_file: &FilePath) -> Result<Config, ConfigCreationError> {",
          "purpose": "Reference parameter pattern with explicit type annotation"
        },
        {
          "file": "iceoryx2-services/discovery/src/service_discovery/tracker.rs",
          "line": [43, 44, 45],
          "code": "fn from(error: ServiceListError) -> Self {\n    match error {\n        ServiceListError::InsufficientPermissions => Self::InsufficientPermissions,",
          "purpose": "Owned parameter in From impl for error type conversion"
        }
      ],
      "count": 2047
    },
    "function_parameter_variadic_part": {
      "fls_section": "9.0.6",
      "fls_ids": [],
      "description": "Function Parameter Variadic Part",
      "status": "not_used",
      "findings": {
        "count": 0,
        "note": "No variadic functions - parameter lists are explicit"
      },
      "samples": [],
      "count": null,
      "count_methodology": "Pattern not defined for this section"
    },
    "return_type": {
      "fls_section": "9.0.7",
      "fls_ids": [],
      "description": "Return Type",
      "status": "demonstrated",
      "findings": {
        "result_returns": 1396,
        "option_returns": 235,
        "self_returns": 1216,
        "never_type": 3
      },
      "samples": [
        {
          "file": "iceoryx2-bb/posix/src/mutex.rs",
          "line": [
            552
          ],
          "code": "pub fn lock(&self) -> Result<MutexGuard<T>, MutexLockError<T>>",
          "purpose": "Result return with lifetime-annotated types"
        },
        {
          "file": "iceoryx2/src/port/listener.rs",
          "line": [
            217
          ],
          "code": "pub fn deadline(&self) -> Option<Duration>",
          "purpose": "Option return for nullable values"
        }
      ],
      "count": 0,
      "samples_waiver": {
        "reason": "insufficient_patterns",
        "explanation": "Only 0 instance(s) found in codebase, fewer than 3 required samples",
        "approved_by": "automated",
        "date": "2025-12-30"
      }
    },
    "function_body": {
      "fls_section": "9.0.8",
      "fls_ids": [],
      "description": "Function Body",
      "status": "demonstrated",
      "findings": {
        "patterns": [
          "early return with ?",
          "match expressions",
          "unsafe blocks"
        ]
      },
      "samples": [
        {
          "file": "iceoryx2-bb/concurrency/src/spin_lock.rs",
          "line": [119, 120, 121],
          "code": "fn drop(&mut self) {\n    self.lock.locked.store(false, Ordering::Release);\n}",
          "purpose": "Drop implementation releasing SpinLock with atomic release ordering"
        },
        {
          "file": "iceoryx2/src/sample.rs",
          "line": [76, 77, 78, 79],
          "code": "fn fmt(&self, f: &mut core::fmt::Formatter<'_>) -> core::fmt::Result {\n    write!(\n        f,\n        \"Sample<{}, {}, {}> {{ ptr: {:?}, details: {:?} }}\",",
          "purpose": "Debug trait implementation with structured write! macro"
        },
        {
          "file": "iceoryx2-bb/container/src/semantic_string.rs",
          "line": [83, 84, 85, 86],
          "code": "fn from(value: StringModificationError) -> Self {\n    match value {\n        StringModificationError::InsertWouldExceedCapacity => {\n            SemanticStringError::ExceedsMaximumLength",
          "purpose": "From trait body with match expression for error conversion"
        }
      ],
      "count": 7904
    },
    "self_parameter": {
      "fls_section": "9.0.9",
      "fls_ids": [],
      "description": "Self Parameter",
      "status": "demonstrated",
      "findings": {
        "ref_self": 1537,
        "ref_mut_self": 265,
        "owned_self": 530
      },
      "samples": [
        {
          "file": "iceoryx2-bb/posix/src/mutex.rs",
          "line": [286, 287, 288, 289],
          "code": "pub fn clock_type(mut self, clock_type: ClockType) -> Self {\n    self.clock_type = clock_type;\n    self\n}",
          "purpose": "Builder method taking mut self by value, returning Self"
        },
        {
          "file": "iceoryx2/src/config.rs",
          "line": [250],
          "code": "pub fn root_path(&self) -> &Path {",
          "purpose": "Getter method taking &self, returning reference"
        },
        {
          "file": "iceoryx2-bb/concurrency/src/spin_lock.rs",
          "line": [119, 120],
          "code": "fn drop(&mut self) {\n    self.lock.locked.store(false, Ordering::Release);",
          "purpose": "Drop trait taking &mut self for cleanup"
        }
      ],
      "count": 3542
    },
    "shorthand_self": {
      "fls_section": "9.0.10",
      "fls_ids": [],
      "description": "Shorthand Self",
      "status": "demonstrated",
      "findings": {
        "note": "Shorthand self patterns used throughout"
      },
      "samples": [],
      "count": null,
      "count_methodology": "Pattern not defined for this section",
      "samples_waiver": {
        "reason": "conceptual_section",
        "explanation": "This section describes an abstract concept not directly mappable to concrete code patterns",
        "approved_by": "automated",
        "date": "2025-12-30"
      }
    },
    "typed_self": {
      "fls_section": "9.0.11",
      "fls_ids": [],
      "description": "Typed Self",
      "status": "demonstrated",
      "findings": {
        "note": "Typed self used in some advanced patterns"
      },
      "samples": [
        {
          "file": "iceoryx2/src/sample.rs",
          "line": [77, 78, 79, 80],
          "code": "write!(\n    f,\n    \"Sample<{}, {}, {}> {{ ptr: {:?}, details: {:?} }}\",\n    core::any::type_name::<Payload>(),",
          "purpose": "Debug formatting using self in write! macro"
        },
        {
          "file": "iceoryx2/src/waitset.rs",
          "line": [265, 266],
          "code": "fn fmt(&self, f: &mut core::fmt::Formatter<'_>) -> core::fmt::Result {\n    write!(f, \"WaitSetAttachmentError::{self:?}\")",
          "purpose": "Display impl using {self:?} format specifier"
        },
        {
          "file": "iceoryx2/src/node/mod.rs",
          "line": [245, 246, 247],
          "code": "fn fmt(&self, f: &mut core::fmt::Formatter<'_>) -> core::fmt::Result {\n    write!(f, \"NodeId {{ value: {:?} }}\", self.value)",
          "purpose": "Debug formatting accessing self.value in write! macro"
        }
      ],
      "count": 186
    }
  },
  "design_patterns": {
    "no_async": {
      "description": "Zero async functions - deliberate design for real-time IPC systems",
      "rationale": "async/await introduces non-deterministic scheduling, incompatible with real-time requirements"
    },
    "high_unsafe_count": {
      "description": "1,763 unsafe functions (20.9% of all functions)",
      "rationale": "Systems-level IPC requires direct memory manipulation, FFI, and low-level primitives"
    },
    "massive_ffi_layer": {
      "description": "630 extern C functions, 602 #[no_mangle] for C/C++ bindings",
      "rationale": "New in v0.8.0 - comprehensive C API via iceoryx2-ffi/c crate"
    },
    "const_constructors": {
      "description": "const fn new() pattern for compile-time initialization",
      "samples": [
        {
          "file": "iceoryx2-bb/memory/src/heap_allocator.rs",
          "line": [
            26
          ],
          "code": "pub const fn new() -> Self",
          "purpose": "HeapAllocator const constructor"
        },
        {
          "file": "iceoryx2-bb/posix/src/mutex.rs",
          "line": [
            98
          ],
          "code": "pub const fn new() -> Self",
          "purpose": "Mutex const constructor for static initialization"
        }
      ]
    },
    "result_returns": {
      "description": "835 functions return Result - fallible operations with explicit error handling",
      "percentage": "9.9% of functions"
    },
    "builder_pattern": {
      "description": "Methods returning Self (1107 instances) for fluent builder APIs",
      "change_from_v0_7_0": "+428 (+63%)"
    }
  },
  "cross_chapter_references": {
    "chapter_3": "Functions are items (Item declarations)",
    "chapter_4": "Function types, function pointer types, closure types",
    "chapter_5": "Function parameters use irrefutable patterns",
    "chapter_6": "Function bodies are block expressions; call expressions invoke functions",
    "chapter_7": "Functions operate on values; const fn evaluated at compile time",
    "chapter_10": "Associated functions and methods in impl blocks",
    "chapter_12": "Generic parameters and where clauses on functions",
    "chapter_15": "Function parameters have drop scopes; ownership transfer on by-value self",
    "chapter_19": "Unsafe functions and unsafe context requirements",
    "chapter_21": "External functions for FFI - major expansion in v0.8.0"
  }
}